@import "tailwindcss";
@plugin "@tailwindcss/typography";

@custom-variant dark (&:where(.dark, .dark *));

@theme {
  --color-primary: #2563eb;
  --color-primary-hover: #1d4ed8;
  --color-surface: #ffffff;
  --color-surface-secondary: #f6f8fa;
  --color-border: #d1d9e0;
  --color-border-muted: #e5e7eb;
  --color-text-primary: #1f2328;
  --color-text-secondary: #656d76;
  --color-text-link: #0969da;
  --color-success: #1a7f37;
  --color-danger: #d1242f;
  --color-danger-bg: #fef2f2;
  --color-warning: #9a6700;
  --color-warning-bg: #fef3c7;
  --color-info: #2563eb;
  --color-info-bg: #dbeafe;
  --color-merged: #8b5cf6;
  --color-merged-bg: #f3e8ff;
  --color-neutral-bg: #f3f4f6;
  --color-neutral-text: #4b5563;
  --color-diff-add-bg: #dafbe1;
  --color-diff-del-bg: #ffebe9;
  --color-diff-add-text: #116329;
  --color-diff-del-text: #82071e;
  --color-header-bg: #24292f;
  --heatmap-l1: #9be9a8;
  --heatmap-l2: #40c463;
  --heatmap-l3: #30a14e;
  --heatmap-l4: #216e39;

  --animate-progress: progress 1s infinite linear;
  --animate-pulse-subtle: pulse-subtle 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  --animate-fade-in: fade-in 0.15s ease-out;

  @keyframes progress {
    0% {
      transform: translateX(0) scaleX(0);
    }
    40% {
      transform: translateX(0) scaleX(0.4);
    }
    100% {
      transform: translateX(100%) scaleX(0.5);
    }
  }

  @keyframes pulse-subtle {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(4px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
}

/* Dark mode color overrides */
.dark {
  --color-primary: #58a6ff;
  --color-primary-hover: #79c0ff;
  --color-surface: #161b22;
  --color-surface-secondary: #0d1117;
  --color-border: #30363d;
  --color-border-muted: #21262d;
  --color-text-primary: #e6edf3;
  --color-text-secondary: #8b949e;
  --color-text-link: #58a6ff;
  --color-success: #3fb950;
  --color-danger: #f85149;
  --color-danger-bg: #2d1215;
  --color-warning: #d29922;
  --color-warning-bg: #2d2305;
  --color-info: #58a6ff;
  --color-info-bg: #0d1b36;
  --color-merged: #a78bfa;
  --color-merged-bg: #1e1033;
  --color-neutral-bg: #161b22;
  --color-neutral-text: #8b949e;
  --color-diff-add-bg: #12261e;
  --color-diff-del-bg: #2d1215;
  --color-diff-add-text: #3fb950;
  --color-diff-del-text: #f85149;
  --color-header-bg: #010409;
  --heatmap-l1: #0e4429;
  --heatmap-l2: #006d32;
  --heatmap-l3: #26a641;
  --heatmap-l4: #39d353;
}

/* Shiki syntax highlighting — dark mode uses CSS custom properties */
.dark .shiki-line span {
  color: var(--shiki-dark) !important;
  font-style: var(--shiki-dark-font-style) !important;
  font-weight: var(--shiki-dark-font-weight) !important;
}

/* Search result <mark> highlight within syntax-colored code */
.shiki-line mark {
  background-color: rgba(255, 196, 0, 0.3);
  color: inherit;
  border-radius: 2px;
  padding: 1px 0;
}
.dark .shiki-line mark {
  background-color: rgba(255, 196, 0, 0.25);
}

@utility vt-name {
  view-transition-name: var(--vt-name);
}

@utility no-vt {
  view-transition-name: none;
}

@view-transition {
  navigation: auto;
}

@layer base {
  body {
    @apply bg-surface-secondary text-text-primary text-sm antialiased;
    font-family:
      -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans", Helvetica, Arial, sans-serif;
    min-height: 100vh;
  }

  a {
    @apply text-text-link no-underline hover:underline;
  }

  /* Smooth transitions on interactive elements */
  button,
  a,
  input,
  select,
  textarea {
    @apply transition-colors duration-150;
  }

  /* Better focus ring for accessibility */
  input:focus-visible,
  select:focus-visible,
  textarea:focus-visible {
    @apply outline-none ring-2 ring-primary/40 border-primary;
  }

  /* Strip focus ring from inputs inside modals */
  .modal-input:focus-visible {
    @apply ring-0 border-transparent outline-none;
  }
}

@layer components {
  /* Skeleton loading placeholder */
  .skeleton {
    @apply bg-surface-secondary rounded animate-pulse-subtle;
  }

  /* Card surface — hand-drawn style */
  .card {
    @apply bg-surface;
    border: 2px solid var(--color-border);
    border-radius: 255px 15px 225px 15px / 15px 225px 15px 255px;
    box-shadow: 3px 4px 0 var(--color-border-muted);
  }

  /* Status badges — sketchy pill shape */
  .badge {
    @apply inline-flex items-center gap-1 text-xs px-2.5 py-0.5 font-medium;
    border: 1.5px solid currentColor;
    border-radius: 255px 15px 225px 15px / 15px 225px 15px 255px;
  }

  .badge-public {
    @apply text-text-secondary;
    border-color: var(--color-border);
  }

  .badge-private {
    @apply text-warning bg-warning/5;
    border-color: color-mix(in srgb, var(--color-warning) 30%, transparent);
  }

  .badge-open {
    @apply bg-success/10 text-success;
  }

  .badge-closed {
    @apply bg-danger/10 text-danger;
  }

  .badge-merged {
    @apply bg-merged-bg text-merged;
  }

  /* Button base styles — subtly irregular with press effect */
  .btn-primary {
    @apply inline-flex items-center justify-center gap-2 text-sm font-medium
           px-4 py-2 hover:no-underline
           disabled:opacity-50 disabled:cursor-not-allowed bg-success text-white;
    border: 2px solid var(--color-border-muted);
    border-radius: 0.375rem;
    box-shadow: 2px 3px 0 var(--color-border-muted);
    transition: transform 0.15s, box-shadow 0.15s, filter 0.15s, color 0.15s;
  }

  .btn-primary:hover:not(:disabled) {
    transform: translate(1px, 1px);
    box-shadow: 1px 2px 0 var(--color-border-muted);
    filter: brightness(1.1);
  }

  .btn-primary:active:not(:disabled) {
    transform: translate(2px, 3px);
    box-shadow: 0 0 0 var(--color-border-muted);
    filter: brightness(0.95);
  }

  .btn-secondary {
    @apply inline-flex items-center justify-center gap-2 text-sm font-medium
           px-4 py-2 hover:no-underline
           disabled:opacity-50 disabled:cursor-not-allowed bg-surface text-text-primary;
    border: 2px solid var(--color-border);
    border-radius: 0.375rem;
    box-shadow: 2px 3px 0 var(--color-border-muted);
    transition: transform 0.15s, box-shadow 0.15s, background-color 0.15s, color 0.15s;
  }

  .btn-secondary:hover:not(:disabled) {
    @apply bg-surface-secondary;
    transform: translate(1px, 1px);
    box-shadow: 1px 2px 0 var(--color-border-muted);
  }

  .btn-secondary:active:not(:disabled) {
    @apply bg-border-muted;
    transform: translate(2px, 3px);
    box-shadow: 0 0 0 var(--color-border-muted);
  }

  .btn-danger {
    @apply inline-flex items-center justify-center gap-2 text-sm font-medium
           px-4 py-2 hover:no-underline
           disabled:opacity-50 disabled:cursor-not-allowed bg-danger text-white;
    border: 2px solid var(--color-border-muted);
    border-radius: 0.375rem;
    box-shadow: 2px 3px 0 var(--color-border-muted);
    transition: transform 0.15s, box-shadow 0.15s, filter 0.15s, color 0.15s;
  }

  .btn-danger:hover:not(:disabled) {
    transform: translate(1px, 1px);
    box-shadow: 1px 2px 0 var(--color-border-muted);
    filter: brightness(1.1);
  }

  .btn-danger:active:not(:disabled) {
    transform: translate(2px, 3px);
    box-shadow: 0 0 0 var(--color-border-muted);
    filter: brightness(0.95);
  }

  .btn-sm {
    @apply text-sm px-3 py-1.5;
  }

  /* Markdown body — rendered README content */
  .markdown-body {
    @apply text-text-primary text-sm leading-relaxed;
  }

  .markdown-body h1 {
    @apply text-2xl font-bold text-text-primary mt-6 mb-3 pb-2 border-b border-border;
  }

  .markdown-body h2 {
    @apply text-xl font-semibold text-text-primary mt-5 mb-3 pb-1.5 border-b border-border;
  }

  .markdown-body h3 {
    @apply text-lg font-semibold text-text-primary mt-4 mb-2;
  }

  .markdown-body h4,
  .markdown-body h5,
  .markdown-body h6 {
    @apply text-base font-semibold text-text-primary mt-4 mb-2;
  }

  .markdown-body h1:first-child,
  .markdown-body h2:first-child,
  .markdown-body h3:first-child {
    @apply mt-0;
  }

  .markdown-body p {
    @apply my-3;
  }

  .markdown-body a {
    @apply text-text-link underline;
  }

  .markdown-body strong {
    @apply font-semibold;
  }

  .markdown-body ul {
    @apply list-disc pl-6 my-3;
  }

  .markdown-body ol {
    @apply list-decimal pl-6 my-3;
  }

  .markdown-body li {
    @apply my-1;
  }

  .markdown-body li > ul,
  .markdown-body li > ol {
    @apply my-0;
  }

  .markdown-body blockquote {
    @apply border-l-4 border-border pl-4 text-text-secondary my-3;
  }

  .markdown-body code {
    @apply px-1.5 py-0.5 rounded bg-surface-secondary text-sm font-mono;
  }

  .markdown-body pre {
    @apply p-4 rounded-md border border-border bg-surface-secondary overflow-x-auto my-3;
  }

  .markdown-body pre code {
    @apply p-0 bg-transparent rounded-none;
  }

  .markdown-body table {
    @apply w-full my-3 border-collapse;
  }

  .markdown-body th {
    @apply px-3 py-2 text-left font-semibold bg-surface-secondary border border-border;
  }

  .markdown-body td {
    @apply px-3 py-2 border border-border;
  }

  .markdown-body img {
    @apply max-w-full rounded;
  }

  .markdown-body hr {
    @apply border-border my-6;
  }

  .markdown-body input[type="checkbox"] {
    @apply mr-1.5;
  }

  .markdown-body del {
    @apply line-through text-text-secondary;
  }

  /* Docs page — method badges */
  .badge-method-get {
    @apply bg-info-bg text-info font-bold font-mono text-xs px-2 py-0.5 rounded border border-info/20;
  }

  .badge-method-post {
    @apply bg-success/10 text-success font-bold font-mono text-xs px-2 py-0.5 rounded border border-success/20;
  }

  .badge-method-patch {
    @apply bg-warning-bg text-warning font-bold font-mono text-xs px-2 py-0.5 rounded border border-warning/20;
  }

  .badge-method-delete {
    @apply bg-danger-bg text-danger font-bold font-mono text-xs px-2 py-0.5 rounded border border-danger/20;
  }

  /* Docs page — auth badges */
  .badge-auth-required {
    @apply bg-danger-bg text-danger text-xs px-2 py-0.5 rounded border border-danger/20;
  }

  .badge-auth-optional {
    @apply bg-warning-bg text-warning text-xs px-2 py-0.5 rounded border border-warning/20;
  }

  .badge-auth-none {
    @apply bg-neutral-bg text-neutral-text text-xs px-2 py-0.5 rounded border border-neutral-text/20;
  }
}
